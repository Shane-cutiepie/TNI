<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {font-family: 'Poppins', sans-serif;background: #f5f5f5;margin: 0;padding: 0;color: #333;}
    header {display: flex;align-items: center;justify-content: space-between;padding: 12px 15px;background: #001F3F;color: white;}
    header img {width: 40px;height: 40px;}
    header h2 {font-size: 20px;margin: 0;}
    .icons a {color: white;font-size: 22px;}
    .cart-container {max-width: 900px;margin: 20px auto 80px;background: white;padding: 20px;border-radius: 12px;box-shadow: 0 2px 8px rgba(0,0,0,0.1);}
    h2 {margin-bottom: 20px;font-size: 22px;color: #001F3F;text-align: center;}
    .cart-item {display: flex;align-items: center;justify-content: space-between;padding: 15px 10px;border-bottom: 1px solid #ddd;}
    .cart-item:last-child {border-bottom: none;}
    .cart-item img {width: 70px;height: 70px;object-fit: cover;border-radius: 10px;margin-right: 15px;}
    .item-details {flex: 1;display: flex;align-items: center;}
    .item-info {flex: 1;}
    .item-info h4 {margin: 0 0 5px;font-size: 16px;color: #001F3F;}
    .item-info p {margin: 0;font-size: 14px;color: #555;}
    .qty-controls {display: flex;align-items: center;margin-right: 15px;}
    .qty-controls button {background: #001F3F;color: white;border: none;width: 28px;height: 28px;cursor: pointer;border-radius: 6px;font-size: 16px;}
    .qty-controls span {margin: 0 10px;font-size: 15px;}
    .remove-btn {background: #FF4136;color: white;border: none;padding: 6px 10px;cursor: pointer;border-radius: 6px;font-size: 13px;}
    .cart-summary {margin-top: 20px;text-align: right;font-size: 18px;font-weight: 600;}
    .checkout-btn {display: block;width: 100%;margin-top: 20px;background: #FF851B;color: white;border: none;padding: 14px;font-size: 18px;cursor: pointer;border-radius: 10px;font-weight: bold;}
    .checkout-btn:hover {background: #FF6300;}
    footer {position: fixed;bottom: 0;width: 100%;background: #001F3F;display: flex;justify-content: space-around;padding: 8px 0;}
    footer a {color: #fff;font-size: 12px;text-align: center;display: flex;flex-direction: column;align-items: center;gap: 3px;}
    footer i {font-size: 22px;transition: .2s;}
    footer a:hover i {transform: scale(1.2);color: #FF7F50;}
  </style>
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo">
    <h2>My Cart</h2>
    <div class="icons"><a href="homepage.html"><i class="fas fa-home"></i></a></div>
  </header>

  <div class="cart-container">
    <h2>Your Cart</h2>
    <div id="cart-items"></div>
    <div class="cart-summary">
      <p>Total: ₱<span id="cart-total">0.00</span></p>
    </div>
    <button class="checkout-btn" id="checkoutBtn">Proceed to Checkout</button>
  </div>

  <footer>
    <a href="scan.html"><i class="fas fa-qrcode"></i><span>Scan</span></a>
    <a href="chat.html"><i class="fas fa-comment-dots"></i><span>Chat</span></a>
    <a href="homepage.html"><i class="fas fa-home"></i><span>Home</span></a>
    <a href="alerts.html"><i class="fas fa-bell"></i><span>Alerts</span></a>
    <a href="bag.html"><i class="fas fa-bag-shopping"></i><span>Bag</span></a>
  </footer>

  <script>
    function renderCart() {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      let cartItemsContainer = document.getElementById("cart-items");
      let cartTotal = 0;
      cartItemsContainer.innerHTML = "";

      cart.forEach((item, index) => {
        let price = parseFloat(item.price.toString().replace(/[^0-9.-]+/g,"")) || 0;
        cartTotal += price * item.qty;

        let div = document.createElement("div");
        div.classList.add("cart-item");
        div.innerHTML = `
          <div class="item-details">
            <img src="${item.img}" alt="${item.name}">
            <div class="item-info">
              <h4>${item.name}</h4>
              <p>₱${price.toFixed(2)}</p>
            </div>
          </div>
          <div class="qty-controls">
            <button onclick="updateQty(${index}, -1)">-</button>
            <span>${item.qty}</span>
            <button onclick="updateQty(${index}, 1)">+</button>
          </div>
          <button class="remove-btn" onclick="removeItem(${index})">Remove</button>
        `;
        cartItemsContainer.appendChild(div);
      });

      document.getElementById("cart-total").innerText = cartTotal.toFixed(2);
      localStorage.setItem("cartTotal", cartTotal.toFixed(2));
      localStorage.setItem("cart", JSON.stringify(cart));
    }

    function updateQty(index, change) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart[index].qty += change;
      if (cart[index].qty <= 0) cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    // ✅ Redirect and keep cart data
    document.getElementById("checkoutBtn").addEventListener("click", () => {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      if (cart.length === 0) {
        alert("Your cart is empty!");
        return;
      }
      localStorage.setItem("cart", JSON.stringify(cart)); // keep for checkout.php
      window.location.href = "checkout.php";
    });

    renderCart();
  </script>
</body>
</html>
